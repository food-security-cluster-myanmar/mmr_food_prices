"0","prices %>% 
  filter(pricetype == ""Retail"") %>% 
  select(commodity, admin1, admin2, date, price, market, year) %>% 
  rbind(mau %>% select(-filename)) %>% 
  filter(year >= 2020) %>%  
  group_by(commodity) %>% 
  mutate(count = sum(!is.na(commodity))) %>% 
  ungroup() %>% 
  filter(count > 500 & price > 20) %>%
  group_by(date, commodity, admin1) %>% 
  summarise(price = mean(price)) %>% 
  filter(commodity %in% c(""Salt"", ""Tomatoes (local)"", ""Rice (low quality)"", 
                          ""Pulses"", ""Oil (palm)"", ""Onions (local)"")) %>% 
  group_by(commodity, admin1) %>% 
  arrange(date) %>% 
  filter(row_number() == 1 | row_number() == n()) %>%
  mutate(order = c(""first"", ""last"")) %>%
  select(-date) %>% 
  pivot_wider(names_from = order, values_from = price) %>% 
  mutate(difference = (last - first) / first, 
         # this changes the anomalous value for salt in Shan East
         difference = ifelse(difference > 2.5, 2.5, difference)) %>%
  ggplot(aes(x = difference, y = fct_rev(admin1), fill = commodity)) + 
  geom_vline(xintercept = 1, lty = 2, colour = ""red"") +
  geom_col(position = position_dodge(width = .9)) + 
  facet_wrap(~commodity) +
  scale_fill_manual(values = c(""#4686fbff"", ""#26A69A"", ""#30123bff"",
                               ""#e4460aff"", ""#e4cf5bff"", ""#9c179eff"")) +
  scale_x_continuous(labels = percent, breaks = seq(-1, 2.5, by = .5)) +
    theme(legend.position = ""none"", 
        strip.text = element_text(size = 10, face = ""bold""), 
        strip.background = element_rect(fill = ""#212121"")) + 
  guides(colour = guide_legend(nrow = 1)) +
  labs(x = ""% change in prices"", y = """",  
       title = ""Changes in commodity prices, 2020-2022"",
       subtitle = ""Prices are MMK per kg, except for palm oil which is MMK per litre; red line indicates a 100% increase"",
       caption = ""Data sources: WFP and Mercy Corps MAU"") 
"
"2","`summarise()` has grouped output by 'date', 'commodity'. You can override using the `.groups` argument.
"
