"0","knitr::opts_chunk$set(echo = FALSE, fig.width = 9, message = FALSE, warning = FALSE)"
"0",""
"0","library(tidyverse) "
"0","library(lubridate)"
"0","library(viridis)"
"0","library(scales)"
"0","library(data.table)"
"0","library(janitor)"
"0","library(patchwork)"
"0",""
"0","theme_set(theme_light())"
"0",""
"0","prices <- read_csv(""./data/wfp_food_prices_mmr.csv"") %>% "
"0","  filter(!row_number() %in% c(1)) %>% "
"0","  mutate_at(vars(longitude, latitude, price, usdprice),"
"0","            ~ as.numeric(.x)) %>% "
"0","  mutate(date = ymd(date), "
"0","         year = year(date)) %>% "
"0","  mutate(source = ""WFP"")"
"2","[1mRows: [22m[34m33783[39m [1mColumns: [22m[34m14[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (14): date, admin1, admin2, market, latitude, longitude, category, commodity, unit, priceflag, pricetype, currency, price, usdprice
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"0","# I wish I could do this whole process with something like"
"0","# mau <- dir(""data, full.names = TRUE) %>% map_df(read_csv)"
"0","# But unfortunately, these files require some cleaning "
"0",""
"0","mau_files <- list.files(""./data/mpr_se_data"")"
"0",""
"0","# Empty vector to store results "
"0",""
"0","mau_list <- vector(""list"", length(mau_files))"
"0",""
"0","# The for loop for cleaning and merging "
"0",""
"0","for(i in 1:length(mau_files)) {"
"0","  "
"0"," mau_list[[i]] <- read_csv(paste0(""./data/mpr_se_data/"", mau_files[i])) %>%"
"0","   clean_names() %>%"
"0","   rename(commodity = x1) %>%"
"0","   # Note that you can't just specify column types since the number of "
"0","   # columns is not consistent across the files"
"0","   mutate_at(vars(-c(commodity, category)), ~ as.numeric(.x)) %>%"
"0","   pivot_longer(-c(commodity, category), "
"0","         names_to = ""location"", values_to = ""price"") %>% "
"0","   mutate(filename = paste0(mau_files[i]),"
"0","          date = str_remove(filename, ""MPR_SE_""),"
"0","          date = str_remove(date, "".csv""), "
"0","          date = ym(date) + days(14), "
"0","          location = str_to_title(location)) %>% "
"0","   filter(!is.na(price)) %>% "
"0","   # Converting viss into kg"
"0","   mutate(price = ifelse(str_detect(commodity, ""viss""), price * 1.63293, price),"
"0","          commodity = str_replace(commodity, ""viss"", ""kg""))"
"0"," "
"0"," mau <- bind_rows(mau_list) %>%"
"0","   rename(admin2 = location) %>% "
"0","   left_join(prices %>% select(admin1, admin2), by = ""admin2"") %>% "
"0","   mutate(admin1 = case_when(admin2 == ""Hpapun"" ~ ""Kayin"", "
"0","                            admin2 == ""Taungoo"" ~ ""Bago"", "
"0","                            admin2 == ""Hpruso"" ~ ""Kayah"", "
"0","                            TRUE ~ admin1)) %>%"
"0","   distinct(commodity, admin1, admin2, price, date, filename) %>% "
"0","   mutate(commodity = recode(commodity, "
"0","                            ""Cheaper Rice (1 kg)"" = ""Rice (low quality)"", "
"0","                            ""Palm Oil (1 liter)"" = ""Oil (palm)"", "
"0","                            ""Pulse (1 kg)"" = ""Pulses"", "
"0","                            ""Onion (1 kg)"" = ""Onions (local)"", "
"0","                            ""Chicken (1 kg)"" = ""Meat (chicken)""), "
"0","         market = NA_real_, "
"0","         year = year(date))"
"0","    "
"0","}"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m30[39m [1mColumns: [22m[34m6[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): ...1, Category
[32mdbl[39m (4): Hpapun, Hpruso, Loikaw, Taungoo
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m30[39m [1mColumns: [22m[34m6[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): ...1, Category
[32mdbl[39m (4): Hpapun, Hpruso, Loikaw, Taungoo
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m30[39m [1mColumns: [22m[34m5[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): ...1, Category
[32mdbl[39m (3): Hpapun, Loikaw, Taungoo
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m33[39m [1mColumns: [22m[34m5[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): ...1, Category
[32mdbl[39m (3): Hpapun, Kawkareik, Taungoo
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m33[39m [1mColumns: [22m[34m5[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): ...1, Category
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m33[39m [1mColumns: [22m[34m5[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): ...1, Category
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m33[39m [1mColumns: [22m[34m5[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (3): ...1, Category, Hpapun
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","Warning: NAs introduced by coercion"
"2","New names:
* `` -> ...1
"
"2","[1mRows: [22m[34m33[39m [1mColumns: [22m[34m5[39m
"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (3): ...1, Category, Loikaw
"
"2","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"2","Warning: NAs introduced by coercion"
"0","# show_col(hue_pal()(6)) "
"0","# hue_pal()(6) %>% print()"
"0",""
