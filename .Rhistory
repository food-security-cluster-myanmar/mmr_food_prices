guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 1))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = .5, vjust = 1))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = -.5, vjust = 1))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust = .5))
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust = .5),
strip.text = element_text(size = 10, face = "bold"),
strip.background = element_rect(fill = "#212121"))
y = "% of time",
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of time",
title = "Overall price trends by commodity") +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust = .5),
strip.text = element_text(size = 10, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of time",
title = "Overall price trends by commodity") +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust = .5),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of time",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust = .5),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of time",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 60, hjust = 0, vjust = .5),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#EF5350", "#4DD0E1")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of time",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#4DD0E1", "#EF5350")) +
scale_alpha_continuous(range = c(.8, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of time",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#4DD0E1", "#EF5350")) +
scale_alpha_continuous(range = c(.7, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of observations",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total)
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
group_by(commodity, admin1) %>%
mutate(total = sum(count),
pc = count / total) %>%
mutate(mom = abs(mom)) %>%
group_by(date, commodity, admin1, direction) %>%
summarise(price = mean(price),
mom = mean(mom),
.groups = "drop") %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#4DD0E1", "#EF5350")) +
scale_alpha_continuous(range = c(.7, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of observations",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
mutate(mom = abs(mom)) %>%
group_by(date, commodity, admin1, direction) %>%
summarise(price = mean(price),
mom = mean(mom),
.groups = "drop") %>%
mutate(total = sum(count),
pc = count / total) %>%
ggplot(aes(y = pc, x = commodity,
fill = direction,
group = direction,
alpha = abs(mom))) +
geom_col() +
guides(alpha = "none") +
scale_fill_manual(values = c("#4DD0E1", "#EF5350")) +
scale_alpha_continuous(range = c(.7, 1)) +
scale_y_continuous(labels = percent) +
labs(fill = "Price",
x = "",
y = "% of observations",
title = "Overall price trends by commodity") +
coord_flip() +
facet_wrap(~admin1) +
theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1),
strip.text = element_text(size = 8, face = "bold"),
strip.background = element_rect(fill = "#212121"))
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1) %>%
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1)
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1)
prices %>%
filter(pricetype == "Retail") %>%
select(commodity, admin1, admin2, date, price, market, year) %>%
rbind(mau %>% select(-filename)) %>%
filter(year >= 2021 & price > 20) %>%
group_by(date, commodity, admin1, admin2) %>%
summarise(price = mean(price)) %>%
arrange(date, commodity) %>%
group_by(commodity, admin1, admin2) %>%
mutate(mom = (price - lag(price)) / lag(price)) %>%
filter(!is.na(mom)) %>%
filter(commodity %in% c("Salt", "Tomatoes (local)", "Rice (low quality)",
"Pulses", "Oil (palm)", "Onions (local)")) %>%
mutate(direction = ifelse(mom > 0, "increase", "decrease"),
count = 1,
mom = abs(mom)) %>%
group_by(date, commodity, admin1, direction) %>%
summarise(price = mean(price),
mom = mean(mom),
.groups = "drop")
